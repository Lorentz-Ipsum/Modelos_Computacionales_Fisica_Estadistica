<!DOCTYPE html>
<html lang="es">

  <head>
    <title>Gas Ideal</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="../img/favicon.ico">
    <link rel="stylesheet" href="../css/bootstrap.css">
    <!-- Activamos el código Javascript de Bootstrap y de jQuery -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="../js/bootstrap.js"></script>
    <!-- Numeric.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"> </script>
    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <!-- Importamos MathJax para visualizar LaTeX -->

    <style type="text/css">
      body {
        padding: 45px 0 0 0;
      }

      blockquote {
        font-size: 16px !important;
        font-style: italic;
      }

      canvas {
        height: 400px;
        max-width: 400px;
        max-height: 400px;
      }
    </style>
    <style media="screen">
      .main-content {
        padding: 3rem 1.5rem;
      }
    </style>

  </head>

  <body>
    <!-- Contenedor
    ================================================== -->
    <div class="container">

      <!-- Barra de navegación ======================= -->
      <nav class="navbar navbar-expand-sm navbar-dark bg-dark fixed-top">
        <a class="navbar-brand" href="../index.html">\(\int f(x) dx\)</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample03" aria-controls="navbarsExample03" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Elementos que se agrupan al minimizar-->
        <div class="collapse navbar-collapse" id="navbarsExample03">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="../index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../Memoria.html">Memoria</a>
            </li>
            <!-- <li class="nav-item">
              <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
            </li> -->
            <li class="nav-item dropdown active">
              <a class="nav-link dropdown-toggle" href="#" id="dropdownApplets" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Applets</a>
              <div class="dropdown-menu" aria-labelledby="dropdownApplets">

                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="LimiteCentral.html">Teorema del límite central</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="Kac.html">Anillo de Kac</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="Osciladores.html">Conjunto de osciladores armónicos</a>
                <div class="dropdown-divider"></div>
                <h6 class="dropdown-header">Transformaciones sobre el espacio de fases</h6>
                <a class="dropdown-item" href="Transformaciones.html#baker">Transformación del panadero</a>
                <a class="dropdown-item" href="Transformaciones.html#arnold">Transformación de Arnold</a>
                <div class="dropdown-divider"></div>
                <h6 class="dropdown-header">Gas ideal</h6>
                <a class="dropdown-item" href="Fluctuaciones.html">Expansión libre de un gas</a>
                <a class="dropdown-item" href="Macrocanonica.html">Colectividad macrocanónica</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="Bosefermi.html">Estadísticas de bosones y fermiones</a>
                <div class="dropdown-divider"></div>
                <h6 class="dropdown-header">Modelo de Ising</h6>
                <a class="dropdown-item" href="Ising.html#magnet">Magnetización y transiciones de fase</a>
                <a class="dropdown-item" href="Ising.html#lt">Dimensionalidad y límite termodinámico</a>
                <div class="dropdown-divider"></div>
                <h6 class="dropdown-header">Extra: Vibraciones moleculares</h6>
                <a class="dropdown-item" href="Vibraciones.html#diatomicas">Gas de moléculas diatómicas</a>
                <a class="dropdown-item" href="Vibraciones.html#debye">Teoría de Debye de los sólidos cristalinos</a>
                <div class="dropdown-divider"></div>
              </div>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../Codigos.html">Códigos</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../Bibliografia.html">Bibliografía</a>
            </li>
            <li class="nav-item">
            </li>
          </ul>
          <ul class="navbar-nav">
            <li>
              <a class="nav-link" href="../About.html">About</a>
            </li>
          </ul>
          <!-- <form class="form-inline my-2 my-md-0">
            <input class="form-control" type="text" placeholder="Search">
          </form> -->
        </div>
      </nav>

      <!-- Contenidos  ================================================== -->
      <div class="container" role="main">
        <div class="main-content">
          <h2 id="gases">Gas ideal bidimensional</h2>

          <p class="text-justify">
            Con estas dos simulaciones estudiaremos el caso común de un gas ideal en dos dimensiones. Primero, la expansión libre ilustrará los conceptos de irreversibilidad y fluctuaciones en equilibrio, y
            es un ejemplo claro de acercamiento al equilibrio. Y
            segundo, el estudio de una región específica del gas sirve de ejemplo de sistema en contacto con un foco térmico y de partículas, cuyo análisis se lleva a cabo mediante la colectividad
            macrocanónica.


          <h3 id="equilibrio">Irreversibilidad y fluctuaciones en equilibrio</h3>

          <blockquote class="blockquote w-100">
            <h4>Expansión libre de un gas</h4>

            <p class="text-justify">
              Nuestro sistema es un recipiente dividido en dos por una pared. En una de las mitades hay un gas a temperatura $T$. El experimento empieza
              cuando retiramos la pared (de forma instantánea). Entonces,
              el gas se expande hasta ocupar todo el recipiente, y permanece en este estado de quilibrio. Nunca se observa lo contrario. Decimos que hay una secuencia de estados determinada, el proceso es
              irreversible.
            </p>
          </blockquote>

          <p class="text-justify">
            Expresado en el lenguaje de la Física Estadística, partimos de un estado muy poco probable, por lo que en la evolución del sistema tendrá una dirección muy marcada: aquella en que los estados
            sean más probables <a href="../Bibliografia.html#ref-huang">[huang]</a>. Para que esto ocurra,
            necesitamos que haya un número grande de grados de libertad. Si el sistema está compuesto por pocas partículas, es más probable que todas acaben en sólo una mitad del recipiente, por tanto
            podríamos ver la secuencia inversa. Las fluctuaciones de
            densidad, en el caso de pocas partículas, tienen más peso a la hora de caracterizar el macroestado.
            Veamos por qué.
          </p>
          <p class="text-justify">
            Estudiemos la probabilidad de que haya $N_d$ partículas en el lado derecho y $N_i$ en el izquierdo, con $N = N_i + N_d$. Como ambas regiones tienen el mismo volumen, si consideramos que las
            partículas son independientes entre sí (siguiendo la
            <i>hipótesis del caos molecular</i>) la probabilidad de que una partícula cualquiera esté en uno de los lados es $p={1/2}$. La probabilidad de tener $N_d$ y $N_i$ viene dada por
          </p>
          \begin{equation}\label{eq:gasBinom}
          p\left(N_{d}, N_{i}\right)=\left(\begin{array}{c}
          {N_{d}+N_{i}} \\
          {N_{d}}
          \end{array}\right) p^{N_{d}}(1-p)^{N_{i}}=\left(\begin{array}{c}
          {N} \\
          {N_{d}}
          \end{array}\right)\left(\frac{1}{2}\right)^{N}
          \end{equation}

          <p class="text-justify">
            que es la distribución binomial. De esta expresión ya podemos extraer consecuencias importantes. El máximo de esta distribución ocurre cuando $N_d = N/2$, por lo que esta es la distribución
            más probable. Las situaciones más improbables son aquellas
            en que $N_i$ ó $N_d$ son cero.
          </p>
          <p class="text-justify">
            ¿Cómo de grande es la diferencia entre estas probabilides? Calculemos el cociente entre $p(N, 0)$ y $p(N / 2, N / 2)$:
          </p>
          \begin{equation}
          \frac{p(N, 0)}{p(N / 2, N / 2)}=\frac{N ! /(N ! 0 !)}{N ! /[(N / 2) !(N / 2) !]}=\frac{[(N / 2) !]^{2}}{N !}
          \end{equation}

          <p class="text-justify">
            Para evaluar este cociente utilizamos la aproximación de Stirling para $n ! \simeq n^{n} e^{-n} \sqrt{2 \pi n},$ válida con un error menor del 1\% si $n \geq 5$. Obtenemos entonces que:
          </p>
          \begin{equation}
          \frac{p(N, 0)}{p(N / 2, N / 2)} \simeq \sqrt{\frac{\pi N}{2}} 2^{-N}
          \end{equation}

          <p class="text-justify">
            Es decir, la probabilidad de encontrar todas las partículas concentradas en una región disminuye <i>exponencialmente</i> con el número de partículas. Algunos ejemplos concretos:
          </p>
          $$
          \begin{array}{llll}
          \frac{p(6,0)}{p(3,3)} = 0.05 \qquad &
          \frac{p(20,0)}{p(10,10)} = 5.54\times10^{-6} \qquad &
          \frac{p(100,0)}{p(50,50)} = 9.9\times10^{-30} \qquad &
          \frac{p(300,0)}{p(150,150)} = 6.8\times10^{-90}
          \end{array}
          $$

          <p class="text-justify">
            Es decir, para $6$ partículas, todas se concentran en el mismo lado del recipiente un $5\%$ de las veces. Y cuantas más partículas tengamos, más rápido decaerá esta probabilidad. Con sólo
            $300$ partículas ya tenemos números extraordinariamente
            pequeños, incluso cuando todavía estamos muy lejos del número de Avogadro de partículas $N=6.023 \times 10^{23}$. Con este cálculo se muestra que la irreversibilidad aparece como consecuencia
            del enorme número de partículas que componen un sistema
            macroscópico.
          </p>
          <p class="text-justify">
            Calculemos las fluctuaciones respecto al estado más probable, $N_{d}=N_{i}=N / 2$.
            Si definimos $x$ como la desviación relativa respecto a dicho estado $x=\left(N_{d}-N_{i}\right) / N$, podemos escribir que: $N_{d}=N(1+x) / 2$. Introduciendo esta expresión en la ecuación
            \eqref{eq:gasBinom} y utilizando el desarrollo de Stirling
            obtenemos que la probabilidad de encontrar una desviación $x$ sigue una distribución gaussiana:
          </p>
          \begin{equation}\label{eq:gasGauss}
          p_{N}(x) \simeq \sqrt{\frac{2}{\pi N}} e^{-(N-1) z^{2} / 2}
          \end{equation}

          <p class="text-justify">
            de dispersión $\sigma^{2}=1 /(N-1)$, esto es, más estrecha cuantas más particulas haya en el sistema. Por tanto, una fluctuación es más improbable cuanto más grande sea el sistema.
            Si volvemos a escribir \eqref{eq:gasGauss} en función de $N_{d}-N_{i}=\Delta$, se obtiene que la dispersión en la variable $\Delta$ es $\sigma_{\Delta}^{2}=N$:
          </p>
          \begin{equation}
          p_{N}(\Delta) \simeq \sqrt{\frac{2}{\pi N}} e^{-\Delta^{2} /(2 N)}
          \end{equation}

          <p class="text-justify">
            Tenemos, en resumen, un sistema que se acerca al estado de equilibrio, específicamente, a un estado de equilibrio dinámico. Como en <a href="Osciladores.html">[Osciladores]</a>, la dinámica del sistema no se para,
            sino que fluctúa en torno a su valor ideal. Esta es una situación muy común en la Física Estadística.
          </p>
          <!-- Texto de la simulacion -->
          <hr>
          <p class="text-justify">
            En el applet se puede elegir el <button type="button" class="btn btn-info btn-sm">Número de partículas</button> y la <button type="button" class="btn btn-info btn-sm">Temperatura</button> del gas. El botón <button type="button"
                class="btn btn-warning btn-sm">Histograma</button> muestra una gráfica con la distribución de la diferencia de
            partículas en cada zona.
          </p>
          <p class="text-justify">
            En el panel de la izquierda se dibuja el recipiente con el gas. La línea vertical marca la posición donde originalmente está la pared. Al pulsar <button type="button" class="btn btn-primary btn-sm">Start</button> empieza la evolución del
            sistema, con todas las partículas en la mitad derecha del
            recipiente. En el panel derecho se muestra la diferencia entre el número de partículas entre los lados izquierdo y derecho del recipiente. Las dos lineas horizontales representan el valor de
            $\pm \sqrt{\sigma_{\Delta}^{2}}$ (entre el que $x$ se
            encuentra el $68 \%$ de las veces) y el valor $\pm 3 \sqrt{\sigma_{\Delta}^{2}}$ ($99.7\%$).
          </p>
          <p class="text-justify">
            También se puede elegir si queremos que puedan chocar unas con otras o no pulsando el botón de partículas <button type="button" class="btn btn-info btn-sm">Con o Sin interacción</button> (cuando chocan lo hacen como discos duros), ya
            que todo
            este desarrollo es válido en ambos casos.
          </p>
          <p class="text-justify">
            De hecho, todo este desarrollo es válido para un modelo mucho más sencillo: El modelo de las urnas de Ehrenfest <a href="../Bibliografia.html#ref-huang">[huang]</a>, en el que las partículas no forman parte de un gas, sino que
            consideramos cada lado del recipiente como una urna
            independiente con partículas. En cada paso de tiempo cogemos al azar una partícula de una de las urnas y la movemos al otro lado de la caja. La dinámica de las fluctuaciones sigue la misma ley
            que antes: se distribuye de forma gaussiana con
            dispersión $\sigma^2 = 1/(N-1)$.
          </p>
          <p class="text-justify">
            Cuando el gas está compuesto de $20$ partículas, por ejemplo, la diferencia de partículas entre ambas mitades del recipiente se equilibra rápidamente, y una vez en este estado comienza a
            flutuar alrededor de $0$. La amplitud de estas fluctuaciones
            puede llegar a ser de $10$ partículas, en cuyo caso hay $5$ partículas en una región y $15$ en la otra, pero es muy raro observar que las $20$ partículas se acumulen en la misma región. Sin
            embargo, si disminuimos el número de partículas a $6$ no
            es raro en absoluto ver que todas se concentren en un lado. Se observa en este caso un proceso imposible según las leyes de la termodinámica: un proceso en el que se invierte la evolución
            temporal y la entropía crece.
          </p>
          <hr>
          <!-- El applet empieza aqui -->
          <div style="text-align: center">
            <div class="card card-body bg-light">
              <div class="row">
                <div class="col-md">
                  <canvas id="canvasFluctuacionesMarco" height="400px" width="400px" style="position:absolute"></canvas>
                  <canvas id="canvasFluctuaciones" height="400px" width="400px" style="position:relative"></canvas>
                </div>
                <div class="col-md">
                  <div id="graphFluctuaciones" style="height: 400px;">
                  </div>
                </div>
              </div>
            </div>
            <br>
            <!-- BOTONERA -->
            <form name="botonera" class="card card-body bg-light">
              <div data-name="numero" class="form-group">
                <div class="row" style="text-align: right">
                  <div class="col-md-4">
                    <label class="font-weight-bold" for="nFluctuaciones">Número de partículas (<300): </label>
                  </div>
                  <div class="col-md-8">
                    <input type="number" id="nFluctuaciones" name="nFluctuaciones" min="0" max="300" value="100" class="form-control"></br>
                  </div>
                </div>
              </div>
              <div data-name="temperatura" class="form-group">
                <div class="row" style="text-align: right">
                  <div class="col-md-4">
                    <label class="font-weight-bold" for="tempFluctuaciones">Temperatura: </label>
                  </div>
                  <div class="col-md-8">
                    <input type="number" id="tempFluctuaciones" name="tempFluctuaciones" min="0" max="300" value="1" class="form-control"></br>
                  </div>
                </div>
              </div>
              <div data-name="botones" class="form-group">
                <div class="row" style="text-align: center">
                  <div class="form-group col-md-12">
                    <input type="button" id="startBtnFluc" onclick="startStopFluc()" value="Start" class="btn btn-primary">
                    <input type="button" id="resetBtnFluc" onclick="resetFluc()" value="Reset" class="btn btn-danger">
                    <button class="btn btn-warning" type="button" data-toggle="modal" data-target="#modalFluc" id="histBtnFluc" onclick="plotHistFluc()">Histograma</button>
                    <div class="form-check form-check-inline">
                      <input type="checkbox" class="form-check-input" id="conInterFluc">
                      <label class="form-check-label" for="conInterFluc">Con interacción</label>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- Controles para siguiente y anterior simulacion -->
        <hr>
        <nav aria-label="Page navigation example">
          <ul class="pagination justify-content-center">
            <li class="page-item">
              <a class="page-link previous" href="Transformaciones.html" tabindex="-1">Anterior</a>
            </li>
            <li class="page-item">
              <a class="page-link" href="Macrocanonica.html">Siguiente</a>
            </li>
          </ul>
        </nav>
      </div>

      <!-- Modal Fluctuaciones-->
      <div id="modalFluc" class="modal fade" role="dialog">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title">Distribución de partículas</h4>
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
              <!-- Here is the inside of the modal -->
              <p class="text-justify">Some text in the modal.</p>

              <div style="max-width: 500;max-height:400px;width: 400px;">
                <div id="graphHistFluc" style="height: 400px;width: 100%; position: relative;">
                  <!-- Plotly chart will be drawn inside this DIV -->
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
    </div> <!-- Final del contenedor -->


    <script src="Fluctuaciones.js"> </script>
    <!-- CODIGO DE DERIVATIVE BY MAURICIO POPP -->
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=IntersectionObserver"></script>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ['$', '$'],
            ['\\(', '\\)']
          ],
          processEscapes: true,
          processEnvironments: true,
          tags: "ams",
          macros: {
            edge: '\\mathrel{-}',
            notedge: '\\not\\edge',
            deg: ['#1^°', 1],
            tbold: ['\\textbf{#1}', 1],
            mbold: ['\\mathbf{#1}', 1],
            unit: ['\\widehat{\\mathbf{#1}}', 1],
            v: ['\\overrightarrow{#1}', 1],
            vnorm: ['\\norm{\\v{#1}}', 1],
            overunder: ['\\overset{#2}{\\underset{#3}{#1}}', 3],
            cuv: ['\\overunder{#1}{|}{|}', 1],
            magnitude: ['\\left \\| #1 \\right \\|', 1],
            norm: ['\\lvert #1 \\rvert', 1],
            divides: ['\\,|\\,'],
            cost: ['\\cos{\\theta}'],
            sint: ['\\sin{\\theta}'],
            sqrti: ['\\frac{1}{\\sqrt{2}}'],
            ci: ['\\perp\\!\\!\\!\\perp'],
            given: ['\\:\\vert\\:'],
            bordermatrix: ['\\raise{0.7em}{\\begin{matrix} & \\begin{matrix}#1\\end{matrix} \\\\ \\begin{matrix}#2\\end{matrix} \\hspace{-1em} & #3 \\end{matrix}}', 3]
          }
        },
        options: {
          skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process'
        }
      };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" id="MathJax-script"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <style>
      svg text {
        font-size: 10px;
      }

      svg .title {
        font-size: 25px;
      }

      .function-plot {
        margin: 0px auto 20px;
        display: block;
      }

      .function-plot text {
        font-size: 15px;
      }
    </style>
  </body>

</html>