<!DOCTYPE html>
<html lang="es">

  <head>
    <title>Osciladores</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="../img/favicon.ico">
    <link rel="stylesheet" href="../css/bootstrap.css">
    <!-- Activamos el código Javascript de Bootstrap y de jQuery -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="../js/bootstrap.js"></script>
    <!-- Numeric.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"> </script>
    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <!-- Importamos MathJax para visualizar LaTeX -->

    <style type="text/css">
      body {
        padding: 45px 0 0 0;
      }
    </style>
    <style media="screen">
      .main-content {
        padding: 3rem 1.5rem;
      }
    </style>

  </head>

  <body>
    <!-- Contenedor
    ================================================== -->
    <div class="container">
      <!-- Barra de navegación ======================= -->
      <nav class="navbar navbar-expand-sm navbar-dark bg-dark fixed-top">
        <a class="navbar-brand" href="../index.html">\(\int f(x) dx\)</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample03" aria-controls="navbarsExample03" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Elementos que se agrupan al minimizar-->
        <div class="collapse navbar-collapse" id="navbarsExample03">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="../index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../Memoria.html">Memoria</a>
            </li>
            <!-- <li class="nav-item">
              <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
            </li> -->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="dropdownApplets" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Applets</a>
              <div class="dropdown-menu" aria-labelledby="dropdownApplets">
                <a class="dropdown-item" href="Apps.html">Índice de applets</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="LimiteCentral.html">Teorema del límite central</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="Kac.html">Anillo de Kac</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="Osciladores.html">Conjunto de osciladores armónicos</a>
                <div class="dropdown-divider"></div>
                <h6 class="dropdown-header">Transformaciones sobre el espacio de fases</h6>
                <a class="dropdown-item" href="Transformaciones.html#baker">Transformación del panadero</a>
                <a class="dropdown-item" href="Transformaciones.html#arnold">Transformación de Arnold</a>
                <div class="dropdown-divider"></div>
                <h6 class="dropdown-header">Gas ideal</h6>
                <a class="dropdown-item" href="Gas.html#fluctuaciones">Expansión libre de un gas</a>
                <a class="dropdown-item" href="Gas.html#macro">Colectividad macrocanónica</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="Bosefermi.html">Estadísticas de bosones y fermiones</a>
                <div class="dropdown-divider"></div>
                <h6 class="dropdown-header">Modelo de Ising</h6>
                <a class="dropdown-item" href="Ising.html#magnet">Magnetización y transiciones de fase</a>
                <a class="dropdown-item" href="Ising.html#lt">Dimensionalidad y límite termodinámico</a>
                <div class="dropdown-divider"></div>
                <h6 class="dropdown-header">Extra: Vibraciones moleculares</h6>
                <a class="dropdown-item" href="Vibraciones.html#diatomicas">Gas de moléculas diatómicas</a>
                <a class="dropdown-item" href="Vibraciones.html#debye">Teoría de Debye de los sólidos cristalinos</a>
                <div class="dropdown-divider"></div>
              </div>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../Codigos.html">Códigos</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../Bibliografia.html">Bibliografía</a>
            </li>
            <li class="nav-item">
            </li>
          </ul>
          <ul class="navbar-nav">
            <li>
              <a class="nav-link" href="../About.html">About</a>
            </li>
          </ul>
          <!-- <form class="form-inline my-2 my-md-0">
            <input class="form-control" type="text" placeholder="Search">
          </form> -->
        </div>
      </nav>

      <!-- Contenidos  ================================================== -->
      <div class="container" role="main">
        <div class="main-content">
          <h2 id="osciladores">Ergodicidad y entropía en un conjunto de osciladores armónicos</h2>

          Esta simulación servirá para ilustrar el concepto de ergodicidad y de <i>coarse graining</i> <a href="Bibliografia.html#groot">groot</a>.

          <blockquote class="blockquote w-75">
            <h4>Conjunto de osciladores independientes</h4>
            Tenemos un sistema de $N$ osciladores independientes, cada uno con su frecuencia $\omega_i$, $i = 1,2,...,N$. Podemos describir el estado de cada oscilador con una variable ángulo $\phi_i (t) \in [0,2\pi)$, de
            forma que la evolución de cada oscilador
            viene dada por $\phi_i (t) = \phi_i (0) + \omega_i t$, donde $\phi_i(0)$ es la fase incial del oscilador. La evolución de cada oscilador está determinada por su frecuencia y su fase.
          </blockquote>

          En principio puede parecer que el sistema siempre será periódico, ya que comportamiento individual de cada oscilador armónico es predecible. Un análisis más detallado nos permite entender que, eligiendo
          adecuadamente las frecuencias, podemos preparar
          un estado no periódico. En este caso aparecerá un comportamiento ergódico, llegando a un estado de entropía máxima, de equilibrio.

          La condición que ha de cumplirse es que las frecuencias de los osciladores sean inconmensurables. Matemáticamente esto quiere decir que $r_{ij}={\omega_i}/{\omega_j}$ debe ser irracional para todo $i, j$. Así, no
          importa cuanto tiempo pase, nunca
          volverán a estar en sus posiciones iniciales con la misma diferencia entre las fases. Demostrémoslo con dos osciladores:

          Asumiendo fases iniciales nulas por simplicidad, y frecuencias $\omega_1$ y $\omega_2$, para un tiempo $t$ el estado de los osciladores será $\phi_1(t) = \omega_1 t$ y $\phi_2(t) = \omega_2 t$. Cada oscilador
          volverá a su posición inicial en un
          periodo $T_i = 2\pi / \omega_i$. Supongamos que para que ambos estén en dicha posición a la vez, el primero debe haber pasado $n$ periodos, y el segundo, $m$. La condición de que estén sincronizados implica que $T
          = nT_1 = mT_2$, entonces:

          $$
          \frac{nT_1}{mT_2} = \frac{n \omega_2}{m \omega_1} = 1
          $$

          Si $\omega_1 / \omega_2$ es irracional, esto no puede cumplirse, así que el sistema nunca volverá al estado inicial, y por tanto, será ergódico.

          Volvamos al sistema de estudio, si es ergódico tenemos que la distribución de probabilidad microcanónica equivale al volumen del toro $N$-dimensional donde se mueven las variables $\phi$ <a href="Bibliografia.html#dyson">dyson</a>:

          $$
          \rho (x) = \frac{1}{(2\pi)^N}
          $$

          Para poder aplicar el formalismo de Física Estadística, necesitamos disponer de algún tipo de macroestado con el cual estudiar el sistema. Aquí es donde entra en juego el concepto de <i>coarse graining</i>, que
          implica simplificar los componentes
          de nuestro sistema para estudiar sus propiedades ``suavizadas''. Normalmente se aplica en simulaciones de dinámica molecular, reduciendo moléculas o átomos a estructuras más sencillas como esferas.

          Para ello, dividimos la circunferencia en $M$ sectores, todos equiespaciados. La fracción de osciladores en cada sector la llamaremos $\alpha_i$, y el conjunto $\{\alpha_i\}_{i=1}^M$ será nuestro macroestado.
          Cuando $N \gg 1, M \gg 1$ y $N \gg M$, podemos escribir la entropía de dicho macroestado como:

          \begin{equation}\label{eq:oscS}
          S=-N k_{B} \sum_{j} \alpha_{j} \ln \alpha_{j}
          \end{equation}

          De esta expresión podemos deducir que la entropía máxima posible será:

          \begin{equation}\label{eq:oscSmax}
          S_{\mathrm{max}}=N k_{B} \ln M
          \end{equation}

          Que corresponde con el macroestado en que $\alpha_j = 1/M$ para todo $j$. Como hemos dicho, este macroestado de entropía máxima sólo se alcanzará si el sistema es ergódico <a href="Bibliografia.html#groot">groot</a>. Si no lo es, el sistema
          será
          periódico y su entropía puede
          crecer o decrecer.

          <hr>

          En el applet podemos elegir \button{N} y \button{M}. También las \button{Fases iniciales}, todas iguales o aleatorias, y la \button{Distribución de frecuencias}:

          <ul class="list-group">
            <li class="list-group-item">Aleatorias, de forma que $r_{ij}$ es en buena medida inconmensurable.</li>
            <li class="list-group-item">Casi iguales, aleatorias pero próximas entre sí.</li>
            <li class="list-group-item">Equiespaciadas, de forma que $r_{ij} = i/j$, y por tanto el sistema no es ergódico.</li>
          </ul>

          En el panel izquierdo aparecen representados los osciladores como manecillas de reloj, el ángulo de la manecilla es el estado del oscilador, $\phi_i(t)$. Los sectores aparecen dividiendo el círculo externo. En el
          panel derecho se representa la
          entropía normalizada del sistema, según la fórmula \eqref{eq:oscS}, con un factor de normalización dado por la entropía máxima \eqref{eq:oscSmax}, de forma que dicha entropía máxima corresponde al valor $1$.

          Una vez ajustados los parámetros deseados, hay que pulsar \button{Reset} para inicializarlos antes de pulsar \button{Inicia} para iniciar la simulación. Cuando partimos de fases iniciales nulas la entropía empieza
          siendo baja, y aumenta según los
          osciladores se distribuyen por la circunferencia. Cuando las frecuencias son aleatorias, llega a un valor máximo y no decrece salvo pequeñas fluctuaciones, que son más pequeñas cuanto mayor es el número de
          osciladores. Por otro lado, cuando las
          frecuencias son conmensurables, las fluctuaciones son mucho más grandes y el comportamiento periódico se hace patente, al cabo de cierto número de iteraciones tenemos una fluctuación muy grande de entropía que
          corresponde al retorno al estado
          inicial.

          Esta periodicidad es más difícil de observar cuando las fases iniciales son aleatorias, ya que entonces estamos partiendo de un estado de entropía máxima, y es difícil que las fluctuaciones sean grandes, sean como
          sean las frecuencias. Con esto se
          confirma una de las ideas de Boltzmann acerca de la irreversibilidad: La evolución temporal a estados de desorden se produce porque partimos de sistemas muy ordenados.

          El botón \button{Histograma} calcula el histograma de la distribución del logaritmo de las frecuencias, mostrando que se comportan de manera exponencial <a href="Bibliografia.html#groot">groot</a> según la fórmula de Einstein: $N(S) =
          \exp{S/k_B}.$

          La simulación original fue desarrollada sobre una idea y material de Juan M.R. Parrondo.

          Una posible ampliación a este modelo es el Modelo de Kuramoto, en el que se introduce cierto acoplo entre osciladores, de forma que cuando dos de ellos están cerca sus frecuencias tienden a igualarse, induciéndose
          así comportamientos colectivos.


          <!-- El applet empieza aqui -->
          <div style="text-align: center">
            <div class="class= card card-body bg-light">
              <div class="row">
                <div class="col-md">
                  <canvas id="canvasSec" width="400" height="400" style="position:absolute;">
                    Please update your browser
                  </canvas>
                  <canvas id="canvasOsc" width="400" height="400" style="position:relative;"> </canvas>
                </div>
                <div class="col-md" style="max-height:400px">
                  <div id="graph" style="height: 400px;">
                    <!-- Plotly chart will be drawn inside this DIV -->
                  </div>
                </div>
              </div>
            </div>
            <br>
            <!-- BOTONERA -->
            <form class="class= card card-body bg-light">
              <div class="form-group col-md-12">
                <label>Numero de osciladores: &nbsp;<span id="numeroLectura">20</span></label>
                <input type="range" id="numeroSlider" class="slider custom-range" name="numeroSlider" onchange="updateNum()" min="1" max="100" value="20" step="1">
              </div>
              <div class="form-group col-md-12">
                <label>Numero de sectores: &nbsp;<span id="sectorLectura">5</span></label>
                <input type="range" id="sectorSlider" class="slider custom-range" name="sectorSlider" onchange="updateSec()" min="1" max="100" value="5" step="1">
              </div>
              <div class="form-group col-md-12">
                <label for="freqSelect">Frecuencias iniciales:</label>
                <select id="freqSelect" name="freqSelect" onchange="updateFreq()" class="form-control">
                  <option value="0">Aleatorias</option>
                  <option value="1">Casi iguales</option>
                  <option value="2">Equiespaciadas</option>
                </select>
              </div>
              <div class="form-group col-md-12">
                <label for="faseSelect">Fases iniciales:</label>
                <select id="faseSelect" name="faseSelect" onchange="updateFase()" class="form-control">
                  <option value="0">Aleatorias</option>
                  <option value="1">Nulas</option>
                </select>
              </div>
              <div class="form-group col-md-12">
                <label>Velocidad: &nbsp;<span id="velocidadLectura">1</span></label>
                <input type="range" id="velocidadSlider" class="slider custom-range" name="velocidadSlider" onchange="updateVel()" min="1" max="10" value="1" step="1">
              </div>
              <div class="form-group col-md-12">
                <input id="startButton" type="button" onclick="startStop()" value="  Start  " class="btn btn-primary">
                <input id="resetButton" type="button" onclick="resetPlot()" value="  Reset  " class="btn btn-danger">
                <!-- Boton que abra el modal de bootstrap -->
                <button class="btn btn-warning" type="button" data-toggle="modal" data-target="#myModal" id="histBtn" onclick="plotHist()">Histograma</button>
              </div>
            </form>
          </div>
        </div>
      </div>
      <!-- Modal -->
      <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title">Histograma</h4>
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
              <!-- Here is the inside of the modal -->
              <p>Some text in the modal.</p>

              <div style="max-width: 500;max-height:400px">
                <div id="graphHist" style="height: 400px; position: relative;">
                  <!-- Plotly chart will be drawn inside this DIV -->
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>

        </div>
      </div>
    </div>

    <script type="text/javascript" src="Osciladores.js"></script>
    <!-- CODIGO DE DERIVATIVE BY MAURICIO POPP -->
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=IntersectionObserver"></script>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ['$', '$'],
            ['\\(', '\\)']
          ],
          processEscapes: true,
          processEnvironments: true,
          tags: "ams",
          macros: {
            edge: '\\mathrel{-}',
            notedge: '\\not\\edge',
            deg: ['#1^°', 1],
            tbold: ['\\textbf{#1}', 1],
            mbold: ['\\mathbf{#1}', 1],
            unit: ['\\widehat{\\mathbf{#1}}', 1],
            v: ['\\overrightarrow{#1}', 1],
            vnorm: ['\\norm{\\v{#1}}', 1],
            overunder: ['\\overset{#2}{\\underset{#3}{#1}}', 3],
            cuv: ['\\overunder{#1}{|}{|}', 1],
            magnitude: ['\\left \\| #1 \\right \\|', 1],
            norm: ['\\lvert #1 \\rvert', 1],
            divides: ['\\,|\\,'],
            cost: ['\\cos{\\theta}'],
            sint: ['\\sin{\\theta}'],
            sqrti: ['\\frac{1}{\\sqrt{2}}'],
            ci: ['\\perp\\!\\!\\!\\perp'],
            given: ['\\:\\vert\\:'],
            bordermatrix: ['\\raise{0.7em}{\\begin{matrix} & \\begin{matrix}#1\\end{matrix} \\\\ \\begin{matrix}#2\\end{matrix} \\hspace{-1em} & #3 \\end{matrix}}', 3]
          }
        },
        options: {
          skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process'
        }
      };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" id="MathJax-script"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <style>
      svg text {
        font-size: 10px;
      }

      svg .title {
        font-size: 25px;
      }

      .function-plot {
        margin: 0px auto 20px;
        display: block;
      }

      .function-plot text {
        font-size: 15px;
      }
    </style>
  </body>

</html>